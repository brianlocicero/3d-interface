<!DOCTYPE HTML>
<html>
<head>
	<title>3D Interface</title>
	<meta name="viewport" content="width=device-width, maximum-scale=1.0" />
	<link rel="stylesheet" href="css/reset.css" />
	<link rel="stylesheet" href="css/screen.css" />
	<link rel="stylesheet" href="css/popup.css" />
	<link href='http://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
</head>
<body>

	<!-- materials overlay -->
	<div class="materialsOverlay mfp-hide">
		<h1>Materials</h1>
		<ul class="materials">
			<li class="selected beige" data-material="beige">
				<div></div>
				Beige
			</li>
			<li class="pink" data-material="pink">
				<div></div>
				Pink
			</li>
		</ul>
		<div style="clear:both">&nbsp;</div>
	</div>

	<div class="main">

		<!-- 3d model view -->
		<div class="model">

			<!-- images -->
			<!--
			<div class="imageHolder" id="imageHolder">
				<img src="img/building1.jpg" class="selected beige"/>
				<img src="img/building2.jpg" class="pink"/>
			</div>
			-->

			<div class="sceneHolder" id="sceneHolder">
			</div>

			<!-- menu -->
			<div class="menu">
				<div class="buttons">
					<a id="rotate">Rotate</a>
					<a id="materials">Materials</a>
				</div>
			</div>

		</div>

		<div class="output">
			<label>Drag Distance:</label> <input type="text" id="dragDistance" />
			<label>Drag Angle:</label> <input type="text" id="dragAngle" />
			<label>Drag Direction:</label> <input type="text" id="dragDirection" />
		</div>

	</div>

<script src="js/jquery.min.js"></script>
<script src="js/hammer.min.js"></script>
<script src="js/popup.js"></script>
<script src="js/three.js"></script>
<script src="js/menu-3d.js"></script>

<script>
/*
	Three.js "tutorials by example"
	Author: Lee Stemkoski
	Date: July 2013 (three.js v59dev)
 */

// MAIN

// standard global variables
var container, scene, camera, renderer, stats;
//var keyboard = new KeyboardState();
var clock = new THREE.Clock();

// custom global variables
var mesh;

init();
animate();

// FUNCTIONS 		
function init() 
{
	// SCENE
	scene = new THREE.Scene();

	// CAMERA
	var SCREEN_WIDTH = 1024, SCREEN_HEIGHT = 566;
	var VIEW_ANGLE = 45, ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT, NEAR = 0.1, FAR = 20000;
	camera = new THREE.PerspectiveCamera( VIEW_ANGLE, ASPECT, NEAR, FAR);
	scene.add(camera);
	camera.position.set(0,150,400);
	camera.lookAt(scene.position);

	// RENDERER
	renderer = new THREE.WebGLRenderer( {antialias:true} );
	//renderer = new THREE.CanvasRenderer();
	renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
	container = document.getElementById( 'sceneHolder' );
	container.appendChild( renderer.domElement );

	// LIGHT
	var light = new THREE.PointLight(0xffffff);
	light.position.set(100,250,100);
	scene.add(light);

	// FLOOR
	var floorTexture = new THREE.ImageUtils.loadTexture( 'img/checkerboard.jpg' );
	floorTexture.wrapS = floorTexture.wrapT = THREE.RepeatWrapping; 
	floorTexture.repeat.set( 10, 10 );
	var floorMaterial = new THREE.MeshBasicMaterial( { map: floorTexture, side: THREE.DoubleSide } );
	var floorGeometry = new THREE.PlaneGeometry(1000, 1000, 10, 10);
	var floor = new THREE.Mesh(floorGeometry, floorMaterial);
	floor.position.y = -0.5;
	floor.rotation.x = Math.PI / 2;
	scene.add(floor);

	// SKYBOX
	var skyBoxGeometry = new THREE.CubeGeometry( 10000, 10000, 10000 );
	var skyBoxMaterial = new THREE.MeshBasicMaterial( { color: 0x9999ff, side: THREE.BackSide } );
	var skyBox = new THREE.Mesh( skyBoxGeometry, skyBoxMaterial );
	scene.add(skyBox);
	
	////////////
	// CUSTOM //
	////////////
	
	var geometry = new THREE.CubeGeometry( 100, 100, 100, 1, 1, 1 );
	var material = new THREE.MeshPhongMaterial( { color: 0xd6ccbe } );
	mesh = new THREE.Mesh( geometry, material );
	mesh.position.set(0,40,60);
	scene.add(mesh);
	
}

  var rotObjectMatrix;
  function rotateAroundObjectAxis (object, axis, radians) {
    rotObjectMatrix = new THREE.Matrix4();
    rotObjectMatrix.makeRotationAxis(axis.normalize(), radians);

    // old code for Three.JS pre r54:
    // object.matrix.multiplySelf(rotObjectMatrix);      // post-multiply
    // new code for Three.JS r55+:
    object.matrix.multiply(rotObjectMatrix);

    // old code for Three.js pre r49:
    // object.rotation.getRotationFromMatrix(object.matrix, object.scale);
    // new code for Three.js r50+:
    object.rotation.setEulerFromRotationMatrix(object.matrix);
  }

function animate() 
{
	var xAxis = new THREE.Vector3(1,0,0);
	rotateAroundObjectAxis(mesh, xAxis, Math.PI / 180);
  requestAnimationFrame( animate );
	render();		
}

function render() 
{
	renderer.render( scene, camera );
}

</script>

</body>
</html>